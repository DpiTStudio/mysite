# Документация приложения Logfiles

Приложение `logfiles` предназначено для управления серверными логами через административную панель Django. Оно позволяет просматривать, очищать и создавать резервные копии лог-файлов, хранящихся на сервере.

## Обзор
Приложение автоматически сканирует директорию логов, регистрирует файлы в базе данных и предоставляет интерфейс для:
- Просмотра списка логов с их размером и датой изменения.
- Предпросмотра последних строк лог-файла прямо в админке.
- Создания резервных копий логов.
- Очистки содержимого логов (с автоматическим созданием бэкапа перед очисткой).
- Скачивания резервных копий.

---

## Описание файлов

### 1. `admin.py`
Центральный файл логики приложения. Содержит настройку административного интерфейса и реализацию действий над файлами.

**Классы:**

#### `LogFileAdmin(admin.ModelAdmin)`
Админка для управления файлами логов.
- **Отображение (`list_display`):** Имя, путь, размер, дата изменения, кол-во копий, кнопки действий.
- **Логика синхронизации (`changelist_view`):** При открытии списка логов автоматически сканирует папку `logs` в форме проекта и регистрирует/обновляет файлы в БД.
- **Действия (Колонки/Кнопки):**
    - `backups_count`: Ссылка на список резервных копий для данного файла.
    - `actions_column`: Генерирует HTML-кнопки "Создать копию", "Очистить", "Обновить".
    - `file_content_preview`: Читает последние 50 строк файла и выводит их в блоке `<pre>` для предпросмотра.
- **Custom Views (Кастомные действия):**
    - `create_backup(request, logfile_id)`: Копирует файл в папку бэкапов с временной меткой.
    - `clear_log(request, logfile_id)`: Полностью очищает содержимое файла (с предварительным бэкапом).
    - `refresh_log(request, logfile_id)`: Принудительно обновляет информацию о файле.

#### `LogBackupAdmin(admin.ModelAdmin)`
Админка для управления резервными копиями.
- **Отображение:** Файл лога, файл бэкапа, размер, дата создания, ссылка на скачивание.

### 2. `apps.py`
Конфигурация приложения.
- `verbose_name = 'Управление логами'`: Имя в админке.

### 3. `models.py`
Модели данных для хранения мета-информации о файлах.

**Классы:**

#### `LogFile(models.Model)`
Хранит информацию о физическом файле лога.
- Поля: Название, путь, размер, время изменения.

#### `LogBackup(models.Model)`
Хранит историю резервных копий.
- Поля: Ссылка на файл лога, файл бэкапа (FileField), размер, описание.

### 4. `views.py`
Пустой файл, так как вся логика реализована через административную панель.
